class _patrimonyActive{constructor(t,e=0,i="",a="",n="",s="",l="OUTRO",o=1,r="",u="",c=0,d=2021,m="NOVO",y=0,p=-1,v="",S="",P=0){this.companyid=t,this.dependencyid=e,this.activeId=i,this.active=a,this.details=n,this.activetype=s,this.activesubtype=l,this.quantity=o,this.location=r,this.taxsubject=u,this.taxestimated=c,this.aquisitionyear=d,this.initialstatus=m,this.investment=y,this.supplierid=p,this.currentstatus=v,this.activecode=S,this.sourceid=P}}function patrimonyListOnLoad(t){showNotification(),checkUserStatusAfterExecute(function(){fillSelectDependencyFull("selPatrLisDependency",-1,1),fillSelectPatrimonyType("selPatrLisPatrimonyType",-1),fillSelectPatrimonyType("selPatrDetPatrimonyType"),fillSelectPatrimonySubType("selPatrLisPatrimonySubType",-1),fillSelectPatrimonySubType("selPatrDetPatrimonySubType"),fillSelectPatrimonyTaxSubject("selPatrLisTaxSubject",-1),fillSelectPatrimonyTaxSubject("selPatrDetTaxSubject",-1),fillSelectPatrimonyAquisitionStatus("selPatrDetInitialStatus"),fillSelectSupplier("selPatrDetSupplier",-1),setTriggerButtonByText("txtPatrLisAquisitionYear","btPatrLisViewAll"),patrimonyListGet(""),hideNotification()})}function patrimonySetNewEdit(t){const e=document.getElementById("btPatrDetDelete"),i=document.getElementById("txtPatrLisActivoId"),a=document.getElementById("txtPatrDetActivo"),n=document.getElementById("txtPatrDetDetails"),s=document.getElementById("selPatrDetPatrimonyType"),l=document.getElementById("selPatrDetPatrimonySubType"),o=document.getElementById("txtPatrDetQuantity"),r=document.getElementById("txtPatrDetLocation"),u=document.getElementById("selPatrDetTaxSubject"),c=document.getElementById("txtPatrDetTaxEstimated"),d=document.getElementById("txtPatrDetAquisitionYear"),m=document.getElementById("selPatrDetInitialStatus"),y=document.getElementById("txtPatrDetInvestment"),p=document.getElementById("selPatrDetSupplier"),v=document.getElementById("txtPatrDetActualStatus"),S=document.getElementById("txtPatrDetActiveCode");if(e.style.display="none",-1==t)i.value="Novo activo",a.value="",n.value="",o.value=1,r.value="",u.value="",c.value=0,y.value=0,p.value=-1,v.value="",S.value="",dispatchOnInputChange();else{var P=SYSTEM_USER_STATUS.companyId;showNotification();var T=new XMLHttpRequest,I="action=getPatrimonyList&companyId="+P+"&dependencyId=-1&activeId="+t+"&type=-1&subType=-1&taxSubject=",E=URL_SA_PATRIMONY_X;T.open("POST",E,!0),T.setRequestHeader("Content-type","application/x-www-form-urlencoded"),T.onreadystatechange=function(){if(4==this.readyState&&200==this.status){JSON.parse(this.responseText).forEach(t=>(function(t){let P=JSON.parse(t);i.value=P.id,a.value=P.active,n.value=P.details,s.value=P.activetype,l.value=P.activesubtype,o.value=P.quantity,r.value=P.location,u.value=P.taxsubject,c.value=Number(P.taxestimated).toFixed(2),d.value=P.aquisitionyear,m.value=P.initialstatus,y.value=Number(P.investment).toFixed(2),p.value=P.supplierid,v.value=P.currentstatus,S.value=P.activecode,checkPermission("1003")&&(e.style.display="inline",e.onclick=function(){patrimonyDelete(P.id)});dispatchOnInputChange()})(t)),hideNotification()}},T.send(I)}setAutoCompleteToFiel("txtPatrDetActivo",31,1),setAutoCompleteToFiel("txtPatrDetDetails",32,1),setAutoCompleteToFiel("txtPatrDetActualStatus",33,1),setAutoCompleteToFiel("txtPatrDetActiveCode",71,1),showParts("divPatrLisPatrimonyDetails")}function patrimonySave(t){var e=!1,i="",a=new _patrimonyActive;if(a.companyid=SYSTEM_USER_STATUS.companyId,a.dependencyid=SYSTEM_USER_STATUS.workplaceId,a.activeId=document.getElementById("txtPatrLisActivoId").value,a.active=reviewString(document.getElementById("txtPatrDetActivo")).toUpperCase(),a.details=reviewString(document.getElementById("txtPatrDetDetails")).toUpperCase(),a.activetype=document.getElementById("selPatrDetPatrimonyType").value,a.activesubtype=document.getElementById("selPatrDetPatrimonySubType").value,a.quantity=document.getElementById("txtPatrDetQuantity").value,a.location=reviewString(document.getElementById("txtPatrDetLocation")).toUpperCase(),a.taxsubject=document.getElementById("selPatrDetTaxSubject").value,a.taxestimated=document.getElementById("txtPatrDetTaxEstimated").value,a.aquisitionyear=document.getElementById("txtPatrDetAquisitionYear").value,a.initialstatus=document.getElementById("selPatrDetInitialStatus").value,a.investment=document.getElementById("txtPatrDetInvestment").value,a.supplierid=document.getElementById("selPatrDetSupplier").value,a.currentstatus=reviewString(document.getElementById("txtPatrDetActualStatus")).toUpperCase(),a.activecode=reviewString(document.getElementById("txtPatrDetActiveCode")).toUpperCase(),a.sourceid=SYSTEM_USER_STATUS.userId,""==a.active&&(e=!0,i+="Deve indicar o activo. <br>"),""==a.initialstatus&&(e=!0,i+="Deve indicar o estado do activo na aquisição. <br>"),1==ST_SA_WAITING_SERVER&&(e=!0,i+="Aguardando resposta do servidor. <br>"),e)return alert(i),!1;showNotification(),ST_SA_WAITING_SERVER=1;var n=new XMLHttpRequest,s="action=savePatrimonyActive&activeInfo="+JSON.stringify(a),l=URL_SA_PATRIMONY_X;n.open("POST",l,!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4==this.readyState&&200==this.status){ST_SA_WAITING_SERVER=0;var t=JSON.parse(n.responseText);1==t.status?(showNotification(t.msg,1),patrimonyListGet(""),hideParts("divPatrLisPatrimonyDetails")):showNotification(t.msg,0)}},n.send(s)}function patrimonyListGet(t){var e=SYSTEM_USER_STATUS.companyId,i=Number(document.getElementById("selPatrLisDependency").value);if(i<=0&&Number(SYSTEM_USER_STATUS.billingprofile)<BILLING_PROFILE_PARTNER_INDEX)return showNotification("Seleccionar uma filial.",0),!1;var a=document.getElementById("selPatrLisPatrimonyType").value,n=document.getElementById("selPatrLisPatrimonySubType").value,s=document.getElementById("selPatrLisTaxSubject").value;showNotification();var l=new XMLHttpRequest,o="action=getPatrimonyList&companyId="+e+"&dependencyId="+i+"&activeId=-1&type="+a+"&subType="+n+"&taxSubject="+s,r=URL_SA_PATRIMONY_X;l.open("POST",r,!0),l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.responseText);t.length<=0?showNotification("Não encontrado.",0):hideDivFilter();var e=t.length,i=document.getElementById("numResultPageNumber"),a=document.getElementById("numResultItems");function n(){var n=Number(i.value),s=Number(a.value),l=(n-1)*s,o=l+s;o>e&&(o=e),setElementInnerHtml("lbResultOnList",o+" / "+e);let r=document.getElementById("tblPatrLisMainTable");r.innerHTML="";for(var u=l,c=l;c<o;c++){var d=t[c];u+=1;let e=JSON.parse(d),i=r.insertRow(-1);i.id="trPatrimonyList"+e.id,i.setAttribute("class","borderGray"+setSelectedRowBackground("SELECTED_ROW_PATRIMONY_LIST",i.id));let a=i.insertCell(-1);a.setAttribute("class","colRowNumber"),a.innerHTML=u;let n=i.insertCell(-1);n.setAttribute("class","colProductId"),n.innerHTML=e.id;let s=i.insertCell(-1);s.style.minWidth="150px",s.innerHTML=e.active,i.insertCell(-1).innerHTML=e.activetype,i.insertCell(-1).innerHTML=e.activesubtype;let l=i.insertCell(-1);l.setAttribute("class","colSimNao"),l.innerHTML=e.quantity;let o=i.insertCell(-1);o.setAttribute("class","colSimNao"),o.innerHTML=e.taxsubject;let y=i.insertCell(-1);y.setAttribute("class","colSimNao"),y.innerHTML=e.aquisitionyear,i.insertCell(-1).innerHTML=e.initialstatus;let p=i.insertCell(-1);p.setAttribute("class","colAmount"),p.innerHTML=formatNumber(e.investment);let v=i.insertCell(-1);v.setAttribute("class","colProductId"),v.innerHTML=e.supplierName,i.insertCell(-1).innerHTML=e.currentstatus;let S=i.insertCell(-1);S.setAttribute("class","colProductId"),S.innerHTML=setLocalDate(e.statusdate,10);let P=i.insertCell(-1);P.setAttribute("class","colProductId"),P.innerHTML=getFirtLastName(e.operatorName)+" ("+e.statussourceid+")";let T=i.insertCell(-1);T.setAttribute("class","noPrint");var m=document.createElement("button");m.setAttribute("class","labelEdit"),m.type="button",m.name=e.id,m.onclick=function(){patrimonySetNewEdit(m.name),setSelectedRowOnClick(i,"SELECTED_ROW_PATRIMONY_LIST")},T.appendChild(m),T.style.textAlign="center",T.style.width="60px"}hideNotification()}i.value=1,setResultTotalPages(i.id,a.id,e),i.onchange=function(){n()},a.onchange=function(){setResultTotalPages(i.id,a.id,e),n()},n()}},l.send(o)}function patrimonyDelete(t){showNotification();var e=new XMLHttpRequest,i="action=deletePatrimonyActive&activeId="+t,a=URL_SA_PATRIMONY_X;e.open("POST",a,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(e.responseText);1==t.status?(showNotification(t.msg,1),patrimonyListGet(""),hideParts("divPatrLisPatrimonyDetails")):showNotification(t.msg,0)}},e.send(i)}