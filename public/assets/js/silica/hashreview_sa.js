var HASH_REVIEW_DOCUMENT_LIST=[];function hashReviewOnLoad(){checkUserStatusAfterExecute(function(){})}function hashReviewGetDocuments(){try{if(1==ST_SA_WAITING_SERVER)return void alert("Aguardando resposta do servidor. <br>");var e={};e.documentType=getElementValue("selHashReviewDocumentType"),showNotification(),ST_SA_WAITING_SERVER=1,HASH_REVIEW_DOCUMENT_LIST=[];var t=new XMLHttpRequest,s="action=getHashReviewDocumentList&filterInfo="+JSON.stringify(e),n=URL_SA_HASH_REVIEW_X;t.open("POST",n,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){ST_SA_WAITING_SERVER=0;try{HASH_REVIEW_DOCUMENT_LIST=JSON.parse(this.responseText)}catch(e){showHttpResponseText(t)}setElementInnerHtml("lbHashReviewFoundedDocs",HASH_REVIEW_DOCUMENT_LIST.length),document.getElementById("divHashReviewProgress").style.width="0%",hideNotification()}},t.send(s)}catch(e){showNotification(e.message,0)}}var HASH_REVIEW_DOCUMENT_IN_PROCESS=-1,HASH_REVIEW_TOTAL_SUCESSFULL=0;function hashReviewSave(){try{if(cleanElement("tblHashReviewDocumentStatus"),HASH_REVIEW_DOCUMENT_LIST.length<=0)return void alert("Não foram encontrados documentos");HASH_REVIEW_DOCUMENT_IN_PROCESS=-1,HASH_REVIEW_TOTAL_SUCESSFULL=0,showNotification("Esta operação pode demorar alguns minutos."),ST_SA_WAITING_SERVER=1,hashReviewProcessDocument()}catch(e){showNotification(e.message,0)}}function hashReviewProcessDocument(){var e=HASH_REVIEW_DOCUMENT_LIST.length;HASH_REVIEW_DOCUMENT_IN_PROCESS+=1,document.getElementById("divHashReviewProgress").style.width=Math.round((HASH_REVIEW_DOCUMENT_IN_PROCESS+1)/e*100)+"%";var t=JSON.parse(HASH_REVIEW_DOCUMENT_LIST[HASH_REVIEW_DOCUMENT_IN_PROCESS]);let s=document.getElementById("tblHashReviewDocumentStatus");var n=s.rows.length+1;let o=s.insertRow(-1);o.setAttribute("class","borderGray");let a=o.insertCell(-1);a.setAttribute("class","colRowNumber"),a.innerHTML=n,a.style.width="10px",o.insertCell(-1).innerHTML=t.invoicenumber;let r=o.insertCell(-1);r.setAttribute("class","colProductId"),r.innerHTML=t.systementrydate;let i=o.insertCell(-1);i.setAttribute("class","colProductId"),i.innerHTML=t.hash;let S=o.insertCell(-1);S.setAttribute("class","colProductId"),S.innerHTML="Processando...",t.documentType=getElementValue("selHashReviewDocumentType");var E=new XMLHttpRequest,_="action=saveHashReview&documentInfo="+JSON.stringify(t),c=URL_SA_HASH_REVIEW_X;E.open("POST",c,!0),E.setRequestHeader("Content-type","application/x-www-form-urlencoded"),E.onreadystatechange=function(){if(4==E.readyState&&200==E.status){try{var t=JSON.parse(E.responseText)}catch(e){showHttpResponseText(E)}var s="Não processado.";if(1==t.status){s=t.hash,HASH_REVIEW_TOTAL_SUCESSFULL+=1,setElementInnerHtml("lbHashReviewSucessStatus",HASH_REVIEW_TOTAL_SUCESSFULL+"/"+e);let n=o.insertCell(-1);n.setAttribute("class","colProductId"),n.innerHTML=s.length}S.innerHTML=s,HASH_REVIEW_DOCUMENT_IN_PROCESS<e-1?hashReviewProcessDocument():(ST_SA_WAITING_SERVER=0,hideNotification())}},E.send(_)}