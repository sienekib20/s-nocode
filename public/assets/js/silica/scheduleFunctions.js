class _activity{constructor(t,e=-1,i="",n="",s="",c="",o="",a="",l="",d="",u="",r=-1){this.companyid=t,this.dependencyid=e,this.activityId=i,this.activity=n,this.details=s,this.localdatetime=c,this.location=o,this.customername=a,this.contacts=l,this.email=d,this.employeename=u,this.sourceid=r}}function scheduleListNewActivity(t){showParts("divSchLisScheduleDetails"),document.getElementById("txtSchLisActivityId").value="Nova actividade",document.getElementById("txtSchLisActivity").value="",document.getElementById("txtSchLisDetails").value="";var e=new Date;e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),document.getElementById("txtSchLisDateTime").value=e.toISOString().slice(0,16),document.getElementById("txtSchLisLocation").value="",document.getElementById("txtSchLisCustomer").value="",document.getElementById("txtSchLisContacts").value="",document.getElementById("txtSchLisEmail").value="",document.getElementById("txtSchLisUser").value="",document.getElementById("txtSchLisActivity").focus(),dispatchOnInputChange()}function scheduleListSaveActivity(t){var e=!1,i="",n=new _activity;if(n.companyid=SYSTEM_USER_STATUS.companyId,n.dependencyid=SYSTEM_USER_STATUS.workplaceId,n.activityId=document.getElementById("txtSchLisActivityId").value,n.activity=reviewString(document.getElementById("txtSchLisActivity")).toUpperCase(),n.details=reviewString(document.getElementById("txtSchLisDetails")).toUpperCase(),n.localdatetime=document.getElementById("txtSchLisDateTime").value,n.location=reviewString(document.getElementById("txtSchLisLocation")).toUpperCase(),n.customername=reviewString(document.getElementById("txtSchLisCustomer")).toUpperCase(),n.contacts=reviewString(document.getElementById("txtSchLisContacts")).toUpperCase(),n.email=reviewEmail(document.getElementById("txtSchLisEmail").value),n.employeename=reviewString(document.getElementById("txtSchLisUser")).toUpperCase(),n.sourceid=SYSTEM_USER_STATUS.userId,""==n.activity&&(e=!0,i+="Deve a actividade. <br>"),""==n.customername&&(e=!0,i+="Deve indicar o cliente. <br>"),1==ST_SA_WAITING_SERVER&&(e=!0,i+="Aguardando resposta do servidor. <br>"),e)return alert(i),!1;showNotification(),ST_SA_WAITING_SERVER=1;var s=new XMLHttpRequest,c="action=saveScheduleActivity&activityInfo="+JSON.stringify(n),o=URL_SA_SCHEDULE_X;s.open("POST",o,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.onreadystatechange=function(){if(4==this.readyState&&200==this.status){ST_SA_WAITING_SERVER=0;var t=JSON.parse(s.responseText);1==t.status?(showNotification(t.msg,1),scheduleListList(""),setAutoCompleteToFiel("txtSchLisActivity",27,1),setAutoCompleteToFiel("txtSchLisDetails",28,1),setAutoCompleteToFiel("txtSchLisLocation",29,1),setAutoCompleteToFiel("txtSchLisContacts",30,1),setAutoCompleteToFiel("txtSchLisEmail",31,1),customerSetAutoComplete("txtSchLisCustomer"),systemUserAutocomplete("txtSchLisUser"),hideParts("divSchLisScheduleDetails")):showNotification(t.msg,0)}},s.send(c)}function scheduleListOnLoad(t){showNotification(),checkUserStatusAfterExecute(function(){scheduleListList(""),setAutoCompleteToFiel("txtSchLisActivity",27,1),setAutoCompleteToFiel("txtSchLisDetails",28,1),setAutoCompleteToFiel("txtSchLisLocation",29,1),setAutoCompleteToFiel("txtSchLisContacts",30,1),setAutoCompleteToFiel("txtSchLisEmail",31,1),customerSetAutoComplete("txtSchLisCustomer"),systemUserAutocomplete("txtSchLisUser"),setTriggerButtonByText("txtSchLisInitialDate","btSchLisViewAll"),setTriggerButtonByText("txtSchLisEndDate","btSchLisViewAll"),hideNotification()})}function scheduleListList(t){var e=SYSTEM_USER_STATUS.companyId,i=SYSTEM_USER_STATUS.workplaceId,n=document.getElementById("txtSchLisInitialDate").value,s=document.getElementById("txtSchLisEndDate").value;showNotification();var c=new XMLHttpRequest,o="action=getScheduleList&companyId="+e+"&dependencyId="+i+"&activityId=-1&initialDate="+n+"&endDate="+s,a=URL_SA_SCHEDULE_X;c.open("POST",a,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.responseText);t.length<=0?showNotification("Não encontrado.",0):hideDivFilter(),document.getElementById("lbResultOnList").innerHTML=t.length;let i=document.getElementById("tblSchLisMainTable");i.innerHTML="";var e=0;t.forEach(t=>(function(t){e+=1;let n=JSON.parse(t);var s=setLocalDate(n.localdatetime);let c=i.insertRow(-1);c.id="trScheduleList"+n.id,c.setAttribute("class","borderGray"+setSelectedRowBackground("SELECTED_ROW_SCHEDULE_LIST",c.id));let o=c.insertCell(c.cells.length);o.setAttribute("class","colRowNumber"),o.innerHTML=e,c.insertCell(c.cells.length).innerHTML=weekDay(s.getDay())+", "+s.toISOString().slice(0,10);let a=c.insertCell(c.cells.length);a.style.textAlign="center",a.innerHTML=s.toLocaleTimeString().slice(0,5),c.insertCell(c.cells.length).innerHTML=n.activity,c.insertCell(c.cells.length).innerHTML=n.customername,c.insertCell(c.cells.length).innerHTML=n.employeename,c.insertCell(c.cells.length).innerHTML=getFirtLastName(n.operatorName)+" ("+n.sourceid+")";let l=c.insertCell(c.cells.length);l.setAttribute("class","colProductId"),l.innerHTML=setLocalDate(n.entrydate,16);let d=c.insertCell(c.cells.length);d.setAttribute("class","noPrint");let u=document.createElement("button");u.type="button",u.setAttribute("class","labelDetail");const r=n.id;u.onclick=function(){scheduleListActivityEdit(r),setSelectedRowOnClick(c,"SELECTED_ROW_SCHEDULE_LIST")},d.appendChild(u);let S=document.createElement("button");S.setAttribute("class","labelDelete"),S.type="button",S.onclick=function(){scheduleListActivityDelete(r)},d.appendChild(S);let m=document.createElement("button");m.setAttribute("class","labelPrint"),m.type="button",m.onclick=function(){sessionStorage.setItem("activity_to_print",JSON.stringify(n)),window.open("printActivityLayoutA4.php")},d.appendChild(m)})(t)),hideNotification()}},c.send(o)}function scheduleListActivityEdit(t){var e=SYSTEM_USER_STATUS.companyId,i=SYSTEM_USER_STATUS.workplaceId,n=document.getElementById("txtSchLisInitialDate").value,s=document.getElementById("txtSchLisEndDate").value;showNotification();var c=new XMLHttpRequest,o="action=getScheduleList&companyId="+e+"&dependencyId="+i+"&activityId="+t+"&initialDate="+n+"&endDate="+s,a=URL_SA_SCHEDULE_X;c.open("POST",a,!0),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(this.responseText);t.length<=0?showNotification("Não encontrado.",0):hideDivFilter(),t.forEach(t=>(function(t){let e=JSON.parse(t);var i=setLocalDate(e.localdatetime);document.getElementById("txtSchLisActivityId").value=e.id,document.getElementById("txtSchLisActivity").value=e.activity,document.getElementById("txtSchLisDetails").value=e.details,document.getElementById("txtSchLisDateTime").value=i.toISOString().slice(0,16),document.getElementById("txtSchLisLocation").value=e.location,document.getElementById("txtSchLisCustomer").value=e.customername,document.getElementById("txtSchLisContacts").value=e.contacts,document.getElementById("txtSchLisEmail").value=e.email,document.getElementById("txtSchLisUser").value=e.employeename,document.getElementById("txtSchLisActivity").focus(),showParts("divSchLisScheduleDetails"),dispatchOnInputChange()})(t)),hideNotification()}},c.send(o)}function scheduleListActivityDelete(t){if(isNaN(t))return!1;showConfirm("Tem a certeza que deseja apagar esta actividade?",function(){showNotification();var e=new XMLHttpRequest,i="action=deleteScheduleActivityDelete&activityId="+t,n=URL_SA_SCHEDULE_X;e.open("POST",n,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=JSON.parse(e.responseText);1==t.status?(showNotification(t.msg,1),scheduleListList("")):showNotification(t.msg,0)}},e.send(i)})}